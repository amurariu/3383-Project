---
title: "Graphs and Figures - MOMS-PI"
author: "Andreea Murariu"
date: "`r Sys.Date()`"
output: html_document
---

```{r}
#loading the appropriate libraries and datasets
library(DESeq2,quietly=T)
library(ALDEx2,quietly=T)
load("~/Documents/github/3383-Project/data/virginia.groups.Rda") #load Health v BV grouping vector for all 297 metatranscriptome samples
load("~/Documents/github/3383-Project/data/ko.virginia.filt.Rda") #load KO aggregated FILTERED feature table

#mu=0.15 and gamma = 0.5, effect size
load(file="output/aldex.mu0.15.3.Rda")
load(file="output/aldex.mu0.15.5.Rda")
load(file="output/aldex.mu0.15.10.Rda")
load(file="output/aldex.mu0.15.20.Rda")
load(file="output/aldex.mu0.15.50.Rda")
#mu=0.5, effect size
load(file="output/aldex.g0.5.3.Rda")
load(file="output/aldex.g0.5.5.Rda")
load(file="output/aldex.g0.5.10.Rda")
load(file="output/aldex.g0.5.20.Rda")
load(file="output/aldex.g0.5.50.Rda")
#mu=1, effect size
load(file="output/aldex.g.1.3.Rda")
load(file="output/aldex.g.1.5.Rda")
load(file="output/aldex.g.1.10.Rda")
load(file="output/aldex.g.1.20.Rda")
load(file="output/aldex.g.1.50.Rda")


```



```{r}
##graphs & figures

## effect size plots for n=3,10,5
par(mfrow= c(3,3))
aldex.plot(aldex.sub,called.col="purple",test="effect",cutoff.pval=0.01)
aldex.plot(aldex.sub10,called.col="purple",test="effect",cutoff.pval=0.01)
aldex.plot(aldex.sub50,called.col="purple",test="effect",cutoff.pval=0.01)
aldex.plot(aldex.sub.0.5.3,called.col="purple",test="effect",cutoff.pval=0.01)
aldex.plot(aldex.sub.0.5.5,called.col="purple",test="effect",cutoff.pval=0.01)
aldex.plot(aldex.sub.0.5.10,called.col="purple",test="effect",cutoff.pval=0.01)
aldex.plot(aldex.sub.1.3,called.col="purple",test="effect",cutoff.pval=0.01)
aldex.plot(aldex.sub.1.5,called.col="purple",test="effect",cutoff.pval=0.01)
aldex.plot(aldex.sub.1.10,called.col="purple",test="effect",cutoff.pval=0.01)

#generating sensitivity vs. size plots
#step 1: converting the aldex results into data frames
df1<-data.frame(aldex.test.results.3)
df2<-data.frame(aldex.test.results.5)
df3<-data.frame(aldex.test.results.10)
df4<-data.frame(aldex.test.results.20)
df5<-data.frame(aldex.test.results.50)
complete<-rbind(df1,df2,df3,df4,df5)
sizex<-complete$size
sensx<-complete$sens
specx<-complete$spec #combining data frames based on sensitivity/specificity and size, making 2 data frames with which to plot


#calculating FDR and plotting FDR vs. size

```

