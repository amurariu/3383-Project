---
title: "MOMS-PI"
author: "Andreea Murariu"
date: "`r Sys.Date()`"
output: html_document
---
```{r}
#Installation of Packages edgeR, DESeq2, and ALDEx2
library(DESeq2,quietly=T)
library(ALDEx2,quietly=T)

load("~/Documents/GitHub/dossantos2024study/Rdata/virginia.groups.Rda") #load Health v BV grouping vector for all 297 metatranscriptome samples
load("~/Documents/GitHub/dossantos2024study/Rdata/ko.virginia.filt.Rda") #load KO aggregated FILTERED feature table
```

1. ALDEx2 - t-test and Wilcoxon rank-sum test
```{r}
aldexrun <- aldex(ko.virginia.filt,virginia.groups$groups.2,gamma=0.2)
aldex.plot(aldexrun)
```


2. DESeq2 Analysis
```{r}
dds <- DESeqDataSetFromMatrix(countData = ko.virginia.filt,colData = virginia.groups$groups.2, design= ~condition)
deseq2out <- DESeq (dds)
res <- results(deseq2out)
plotMA(res)
res
```

